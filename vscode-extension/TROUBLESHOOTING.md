# 故障排除指南

## 文件被占用问题 (EBUSY错误)

### 问题描述
当您看到类似以下的错误信息时：
```
Error: 转换失败: EBUSY: resource busy or locked, open 'xxx.docx'
```

这表示目标Word文档文件正在被其他程序使用，无法进行写入操作。

### 常见原因

1. **Word文档已打开**：Microsoft Word、WPS Office或其他文档编辑器正在打开目标文件
2. **文件被锁定**：其他程序或进程正在使用该文件
3. **权限问题**：没有足够的权限访问文件或目录
4. **网络驱动器问题**：如果文件位于网络驱动器上，可能存在连接问题

### 解决方案

#### 方案1：关闭占用文件的程序
1. 检查是否有Microsoft Word、WPS Office等程序打开了目标文件
2. 关闭所有可能使用该文件的程序
3. 重新尝试转换

#### 方案2：检查任务管理器
1. 按 `Ctrl + Shift + Esc` 打开任务管理器
2. 在"进程"选项卡中查找可能使用该文件的程序
3. 结束相关进程
4. 重新尝试转换

#### 方案3：使用不同的文件名
1. 在转换时选择不同的输出文件名
2. 或者将文件保存到其他位置
3. 扩展程序会自动尝试生成备用文件名（如 `文件名_1.docx`）

#### 方案4：重启相关程序
1. 完全关闭VS Code
2. 重新启动VS Code
3. 重新尝试转换

#### 方案5：检查文件权限
1. 右键点击目标文件或文件夹
2. 选择"属性" → "安全"
3. 确保您的用户账户有"完全控制"权限
4. 如果需要，以管理员身份运行VS Code

### 自动化解决方案

本扩展已集成智能文件处理机制：

1. **自动重试**：如果文件被占用，会自动重试3次，每次间隔1秒
2. **自动重命名**：如果原文件无法写入，会自动生成备用文件名
3. **友好错误提示**：提供详细的错误信息和解决建议

### 预防措施

1. **转换前关闭文件**：在转换前确保目标Word文件未被其他程序打开
2. **选择专用目录**：为转换输出创建专门的文件夹
3. **定期清理**：删除不需要的临时文件和旧版本文件
4. **避免网络驱动器**：尽量在本地磁盘上进行转换操作

## 其他常见问题

### 权限错误 (EACCES/EPERM)
**症状**：错误信息包含 `EACCES` 或 `EPERM`

**解决方案**：
1. 以管理员身份运行VS Code
2. 检查文件夹权限设置
3. 确保文件不是只读状态
4. 选择有写入权限的其他位置

### 磁盘空间不足 (ENOSPC)
**症状**：错误信息包含 `ENOSPC`

**解决方案**：
1. 清理磁盘空间
2. 删除临时文件
3. 选择其他磁盘位置保存

### 路径过长 (ENAMETOOLONG)
**症状**：错误信息包含 `ENAMETOOLONG`

**解决方案**：
1. 使用较短的文件名
2. 减少目录层级深度
3. 选择更浅的保存位置

## 技术支持

如果上述解决方案都无法解决您的问题，请：

1. 记录完整的错误信息
2. 注明您的操作系统版本
3. 描述具体的操作步骤
4. 联系技术支持

## 版本更新

本扩展会持续改进文件处理机制，建议保持扩展为最新版本以获得最佳体验。 
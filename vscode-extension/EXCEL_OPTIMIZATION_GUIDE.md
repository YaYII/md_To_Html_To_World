# Excel转换质量优化指南

## 概述

本文档描述了对Markdown到Excel转换功能的质量优化改进，以及如何获得最佳转换效果。

## 主要优化内容

### 1. 视觉层次优化

#### 标题样式改进
- **H1标题**: 使用深蓝色背景(#2E75B6)，白色文字，字体大小20pt
- **H2标题**: 使用中蓝色背景(#5B9BD5)，白色文字，字体大小16pt  
- **H3标题**: 使用浅蓝色背景(#B4C6E7)，黑色文字，字体大小14pt
- 形成清晰的视觉层次，便于快速浏览和理解文档结构

#### 内容区域优化
- **代码块**: 使用Courier New字体，浅灰背景(#F8F8F8)，深灰文字(#2E2E2E)
- **引用块**: 使用浅蓝背景(#F0F7FF)，深灰文字(#4A4A4A)，斜体显示
- **表格**: 保持专业的蓝色主题，表头使用深蓝背景，交替行使用浅灰背景

### 2. 布局和可读性优化

#### 列宽调整
- **默认列宽**: 从20增加到25
- **内容列宽**: 从50增加到80，提供更多空间显示长文本
- **类型列宽**: 从15增加到18
- **级别列宽**: 从10增加到12

#### 工作表设置
- **启用按标题分割**: `splitByHeaders: true`，大文档自动分割为多个工作表
- **优化每表行数**: 从1,000,000减少到50,000，提高性能和可读性

### 3. 格式化增强

#### 文本处理
- 保持原始格式化(`preserveFormatting: true`)
- 自动换行支持
- 最大单元格长度限制(32,767字符)

#### 表格处理
- 保留原始表格结构
- 支持表格分离到独立工作表(可选)
- 表格工作表前缀自定义

## 使用建议

### 1. 最佳实践

#### 文档结构
- 使用清晰的标题层次(H1-H6)
- 合理使用列表和表格
- 适当添加代码块和引用

#### 内容组织
- 避免过长的段落
- 使用有意义的标题
- 表格数据保持简洁

### 2. 转换命令

#### 单文件转换
```bash
node nodeexcel/bin/cli.js convert input.md --output output.xlsx
```

#### 批量转换
```bash
node nodeexcel/bin/cli.js batch *.md --output ./excel-output
```

#### 使用自定义配置
```bash
node nodeexcel/bin/cli.js convert input.md --config custom-config.yaml
```

### 3. 配置自定义

#### 创建配置文件
```bash
node nodeexcel/bin/cli.js config create
```

#### 配置文件位置
- 默认: `./excel-config.yaml`
- 自定义: 使用`--config`参数指定

## 质量检查清单

### 转换前检查
- [ ] Markdown语法正确
- [ ] 表格格式规范
- [ ] 图片链接有效
- [ ] 代码块语言标识正确

### 转换后验证
- [ ] 标题层次清晰
- [ ] 表格数据完整
- [ ] 代码块格式正确
- [ ] 列宽适当
- [ ] 颜色主题一致

## 故障排除

### 常见问题

1. **配置文件已存在错误**
   - 解决方案: 使用`--force`参数强制覆盖
   ```bash
   node nodeexcel/bin/cli.js config create --force
   ```

2. **转换失败**
   - 检查Markdown语法
   - 验证文件路径
   - 查看详细日志(`--verbose`)

3. **样式不生效**
   - 确认配置文件路径
   - 检查YAML语法
   - 重新生成配置文件

### 性能优化

1. **大文件处理**
   - 启用按标题分割
   - 调整每表最大行数
   - 使用批量转换

2. **内存使用**
   - 避免过大的单个文件
   - 定期清理临时文件
   - 监控系统资源

## 版本信息

- **优化版本**: v2.0.0
- **更新日期**: 2024年
- **兼容性**: Node.js 14+

## 反馈和支持

如果遇到问题或有改进建议，请:
1. 检查本指南的故障排除部分
2. 查看详细的错误日志
3. 提供具体的复现步骤

---

*本指南将根据用户反馈和功能更新持续改进。*
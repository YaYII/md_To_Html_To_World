# 🚨 Windows Node.js 问题解决方案

## 问题症状

如果您在Windows系统上看到以下错误信息：

```
❌ pnpm 不可用: Command failed: pnpm.exe --version
'pnpm.exe' 不是内部或外部命令，也不是可运行的程序或批处理文件。

❌ npm 不可用: Command failed: npm.exe --version  
'npm.exe' 不是内部或外部命令，也不是可运行的程序或批处理文件。
```

这说明您的系统**没有安装 Node.js**，或者 Node.js 没有正确添加到系统PATH环境变量中。

## 🎯 解决方案

### 方案一：使用插件自动安装（推荐 ⭐）

1. **重新启动编辑器**
   - 完全关闭 VS Code/Cursor
   - 重新打开编辑器

2. **等待自动检测**
   - 插件会自动检测 Node.js 环境
   - 如果没有检测到，会弹出两个对话框：
     - 第一个：红色错误提示 "⚠️ 未检测到 Node.js 环境！"
     - 第二个：蓝色安装选项 "🚀 Markdown to Word 插件需要 Node.js..."

3. **选择自动安装**
   - 在第二个对话框中点击 **"自动安装 Node.js"**
   - 等待 2-5 分钟完成下载和安装
   - 安装完成后重启编辑器

### 方案二：手动安装 Node.js

1. **下载 Node.js**
   - 访问 [https://nodejs.org/](https://nodejs.org/)
   - 下载 **LTS 版本**（长期支持版，推荐 v20.x）

2. **安装 Node.js**
   - 运行下载的安装程序
   - **重要：确保勾选 "Add to PATH" 选项**
   - 完成安装

3. **验证安装**
   - 按 `Win + R` 打开运行对话框
   - 输入 `cmd` 并按回车
   - 在命令提示符中输入：
     ```cmd
     node --version
     npm --version
     ```
   - 如果显示版本号，说明安装成功

4. **重启系统**
   - 重启计算机以确保环境变量生效
   - 重新打开编辑器

### 方案三：便携版安装（高级用户）

如果自动安装失败，可以使用便携版：

1. **下载便携版**
   - 访问 [https://nodejs.org/dist/](https://nodejs.org/dist/)
   - 下载对应系统的 ZIP 文件（如 `node-v20.10.0-win-x64.zip`）

2. **解压安装**
   - 解压到固定目录（如 `C:\nodejs`）
   - 将该目录添加到系统 PATH 环境变量

3. **配置环境变量**
   - 右键"此电脑" → "属性" → "高级系统设置"
   - 点击"环境变量"
   - 在"系统变量"中找到"Path"，点击"编辑"
   - 添加 Node.js 目录路径（如 `C:\nodejs`）

## 🔍 问题诊断

### 检查当前状态

打开命令提示符（cmd）并运行：

```cmd
node --version
npm --version
pnpm --version
yarn --version
```

### 常见问题

1. **"命令不存在"错误**
   - 说明 Node.js 未安装或未添加到 PATH
   - 解决：按照上述方案安装 Node.js

2. **权限问题**
   - 以管理员身份运行编辑器
   - 或者修改 npm 全局安装目录权限

3. **网络问题**
   - 检查防火墙设置
   - 配置代理（如果需要）

4. **插件缓存问题**
   - 重启编辑器
   - 清除插件缓存

## 🚀 验证修复

安装完成后，执行以下步骤验证：

1. **重启编辑器**
2. **打开一个 Markdown 文件**
3. **运行转换命令**
4. **检查输出面板**
   - 应该看到 "✅ Node.js 环境可用"
   - 而不是之前的错误信息

## 💡 预防措施

1. **定期更新 Node.js**
   - 使用 LTS 版本
   - 定期检查更新

2. **备份环境配置**
   - 记录 PATH 环境变量设置
   - 保存安装路径信息

3. **使用版本管理工具**
   - 考虑使用 nvm-windows 管理 Node.js 版本

## 📞 获取帮助

如果上述方案都无法解决问题：

1. **查看详细日志**
   - 打开 VS Code/Cursor 的输出面板
   - 选择 "Markdown to Word - 依赖安装" 频道
   - 复制完整的错误信息

2. **提供系统信息**
   - Windows 版本
   - 编辑器版本
   - 插件版本

3. **联系支持**
   - 将错误信息和系统信息发送给开发者
   - 或在 GitHub 仓库创建 Issue

---

## 🎉 成功标志

当您看到以下信息时，说明问题已解决：

```
✅ Node.js 环境可用
✅ Node.js 依赖已满足
🎉 Markdown to Word 插件依赖安装完成！
```

现在您可以正常使用 Markdown 转 Word 功能了！ 
# 更新日志

所有重要的项目更改都会记录在此文件中。

本项目遵循[语义化版本控制](https://semver.org/lang/zh-CN/)。

## [0.1.11] - 2024-12-21

### 🚀 重大功能更新

#### ✨ 完全基于 Node.js 的转换系统
- **纯 Node.js 架构**: 移除了所有 Python 依赖，实现完全基于 Node.js 的转换系统
- **多格式支持**: 支持 Markdown 转换为 Word、HTML、Excel 三种格式
- **智能图表处理**: 支持 Mermaid、PlantUML、GraphViz 等图表的高质量转换
- **自动依赖管理**: 插件激活时自动检查并安装所有必要依赖

#### 🎯 用户体验优化
- **一键安装体验**: 用户只需安装插件，无需任何手动操作
- **智能包管理器**: 自动选择最佳包管理器（pnpm > yarn > npm）
- **进度提示**: 显示友好的安装进度和状态信息
- **错误容错**: 安装失败提供详细解决方案

#### 🔧 环境兼容性增强
- **跨平台支持**: 完全兼容 Windows、macOS、Linux 系统
- **Node.js 环境检测**: 自动检查 Node.js 环境，提供安装指导
- **包管理器检测**: 支持检测便携版 Node.js 中的 npm/pnpm/yarn
- **VS Code 内置支持**: 优先使用编辑器自带的 Node.js 环境

### 🎨 核心功能特性

#### 📄 Word 文档转换
- **专业文档结构**: 支持封面页、目录页、正文的三页标准结构
- **智能目录生成**: 支持 `[TOC]` 标记，可在任意位置插入目录
- **图表高质量输出**: PNG 格式图表支持 300 DPI 高质量输出
- **表格样式优化**: 完善的表格边框、对齐、样式处理

#### 📊 Excel 文档转换
- **表格标题识别**: 正确识别和处理 HTML 表格的标题行
- **间隔行优化**: 智能间隔行高度控制，提升可读性
- **格式保持**: 保持原始文档的格式和结构

#### 🌐 HTML 输出
- **完整样式支持**: 保持 Markdown 的所有格式和样式
- **图表嵌入**: 支持图表的 SVG/PNG 格式嵌入
- **响应式设计**: 生成的 HTML 支持多设备显示

### 🛠️ 技术架构

#### 🏗️ 模块化设计
- **核心转换器**: 统一的转换接口和处理流程
- **专用处理器**: 针对不同元素类型的专门处理器
- **配置管理**: 灵活的配置系统，支持用户自定义
- **错误处理**: 完善的错误处理和日志系统

#### 📦 依赖优化
- **自动安装系统**: 智能检测和安装 Node.js 依赖
- **依赖检查**: 定期检查依赖完整性（30天周期）
- **状态管理**: 避免重复安装，提升启动速度
- **网络检查**: 自动检测网络连接和服务可用性

### 🔧 配置和命令

#### ⚙️ 配置选项
- **输出格式设置**: 页面大小、方向、字体、行间距等
- **图片处理**: 图片大小限制、质量设置
- **目录控制**: 目录深度、标题、位置设置
- **样式定制**: 表格样式、段落间距、分隔线等

#### 🎮 扩展命令
- **转换命令**: 
  - `生成Word文档` - 直接转换当前 Markdown 文件
  - `生成HTML文档` - 转换为 HTML 格式
  - `生成Excel文档` - 转换为 Excel 格式
  - `批量转换` - 批量处理目录中的文件
- **管理命令**:
  - `配置world文档` - 打开配置界面
  - `手动安装依赖` - 手动管理依赖
  - `检查依赖状态` - 检查环境状态

### 🚨 关键问题解决

#### Windows 环境优化
- **Node.js 检测**: 解决 Windows 下 Node.js 未安装的检测问题
- **命令执行**: 修复 Windows 下包管理器检测失败的问题
- **Sharp 库支持**: 专门优化 Sharp 库在 Windows 下的安装

#### 图表处理优化
- **格式标准化**: 统一图表输出为 PNG 格式，确保 Word 兼容性
- **质量提升**: 设置高 DPI 输出，确保图表清晰度
- **缓存管理**: 优化图表缓存目录管理，提升性能

### 📋 使用方法

1. **安装插件**: 在 VS Code 扩展商店搜索 "Markdown to Word" 并安装
2. **自动配置**: 插件会自动检测和安装所需依赖
3. **开始使用**: 右键点击 .md 文件，选择相应的转换命令
4. **配置调整**: 使用 `配置world文档` 命令自定义转换设置

### 🔄 升级说明

- **从旧版本升级**: 自动迁移配置，无需手动操作
- **依赖更新**: 自动检查和更新依赖到最新兼容版本
- **配置保持**: 所有现有配置和设置保持不变

### 📞 支持与反馈

- **文档**: 查看项目 README 获取详细使用说明
- **问题反馈**: 通过 GitHub Issues 报告问题
- **功能建议**: 欢迎通过抖音、小红书联系作者

---

## 版本兼容性

- **VS Code**: 1.60.0 或更高版本
- **Node.js**: 14.0.0 或更高版本
- **支持平台**: Windows、macOS、Linux
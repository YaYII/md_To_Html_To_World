# 更新日志

所有重要的项目更改都会记录在此文件中。

本项目遵循[语义化版本控制](https://semver.org/lang/zh-CN/)。

## [0.1.9] - 2025-06-12

### 修复问题 🐛
- **表格标题行修复**: 修复了HTML表格转换为Excel时，表格标题行 (thead) 未能正确识别和加粗显示的问题。
  - 增强了 `htmlToExcelConverter.js` 中对 `<thead>` 元素的检测逻辑。
  - 确保了表格标题行的单元格在Excel中应用了正确的加粗样式。
  - 通过了 `verify_excel_output.js` 脚本的验证，确认标题行在生成的Excel文件中正确显示。

## [0.1.8] - 2025-06-11

### 新增功能 ✨
- **Excel转换间隔行优化**: 新增智能间隔行高度控制功能
  
  - 提升Excel文档的可读性和视觉层次
  - 支持自定义间隔行高度设置

- **HTML到Excel转换增强**: 改进了HTML内容到Excel的转换质量
  - 优化了行高计算逻辑
  - 改进了内容行的间距处理
  - 增强了表格和文本内容的布局效果

### 改进功能 🚀
- **转换性能优化**: 提升了大文档的转换速度
  - 优化了间隔行的添加算法
  - 改进了Excel文件的生成效率
  - 减少了内存占用

### 修复问题 🐛
- **间隔行处理**: 修复了间隔行高度设置不生效的问题

  - 修复了空白行识别逻辑
  - 改进了行高重置机制

### 技术改进 🔧
- **代码结构优化**: 重构了Excel转换相关代码
  - 分离了间隔行处理逻辑
  - 改进了代码可维护性
  - 增强了调试信息输出

## [0.1.6] - 2025-05-29

### 新增功能 ✨
- **智能TOC标记支持**: 支持 `[TOC]` 标记，可以在Markdown文档中的任意位置插入目录
  - 支持大小写不敏感：`[TOC]`、`[toc]`、`[Toc]` 等
  - 支持前导空格和制表符：`  [TOC]`、`\t[toc]`
  - 目录会在标记位置精确插入，而不是固定在文档开头

- **专业三页文档结构**: 符合专业文档标准的页面布局
  - 第一页：封面页（基于文档内容自动生成）
  - 第二页：目录页（独占页面，完整目录列表）
  - 第三页开始：正文内容

- **智能封面页生成**: 基于文档实际内容生成封面页
  - 自动提取文档第一个标题作为封面标题
  - 提取文档开头描述性内容作为简介
  - 不会添加用户未明确提供的信息（版本号、作者等）
  - 保持简洁、专业的外观

### 改进功能 🚀
- **目录分页优化**: 目录现在独占页面，前后都有分页符
  - 确保目录在第二页独立显示
  - 正文从第三页开始，避免内容混乱

- **TOC标记处理增强**: 改进了Markdown转HTML的TOC标记处理
  - 更宽松的正则表达式匹配
  - 支持更多格式变体
  - 更好的边界情况处理

- **配置简化**: 移除了封面页的预设配置项
  - 不再需要配置版本号、作者等信息
  - 封面内容完全基于文档实际内容
  - 减少了用户配置的复杂性

### 修复问题 🐛
- **段落线配置显示**: 修复了配置界面中段落线选项不显示的问题
  - 添加了缺失的CSS样式定义
  - 修复了HTML结构不一致的问题
  - 完善了VS Code配置更新的错误处理

- **VS Code配置注册**: 解决了"没有注册配置"的错误提示
  - 改进了配置更新机制
  - 添加了分层配置更新策略
  - 增强了错误容错能力

### 技术改进 🔧
- **代码模块化**: 所有功能都按模块化原则组织
  - 封面页生成独立为专门方法
  - TOC处理逻辑分离
  - 更好的代码可维护性

- **调试信息增强**: 添加了详细的调试日志输出
  - TOC标记检测日志
  - 封面页生成过程日志
  - 文档结构组织日志

- **配置文档完善**: 更新了配置文件和README文档
  - 清晰的功能说明
  - 实用的使用示例
  - 完整的配置选项说明


---

## 更新说明

### 如何更新
1. 在VS Code中打开扩展面板
2. 搜索"Markdown to Word Converter"
3. 点击"更新"按钮

### 兼容性
- VS Code版本要求：1.60.0 或更高
- Node.js版本要求：14.0.0 或更高
- 支持平台：Windows、macOS、Linux

### 反馈和支持
- 如果遇到问题，请查看 [故障排除指南](https://github.com/YaYII/md_To_Html_To_World/blob/main/vscode-extension/README_FILE_HANDLING.md)
- 功能建议和问题反馈：请通过抖音、小红书联系作者
- 项目地址：[https://github.com/YaYII/md_To_Html_To_World/blob/main/vscode-extension/]